# AGENTS.md - MinionAH Newsroom

Guidelines for AI agents working in this repository.

## Project Overview

MinionAH Newsroom is a SvelteKit-based blog/news site for MinionAH. It uses:

- **Svelte 5** with runes (`$props()`, `$derived()`, `$state()`)
- **SvelteKit** with Cloudflare Pages adapter
- **Tailwind CSS v4** (new CSS-based config)
- **Velite** for content collection (markdown posts)
- **MDSX** for markdown processing with custom blueprints
- **shadcn-svelte** for UI components

## Build & Development Commands

```bash
# Install dependencies
pnpm install

# Development server (runs velite + vite in parallel)
pnpm dev

# Production build
pnpm build

# Type checking
pnpm check

# Lint (prettier + eslint + svelte-check)
pnpm lint

# Format code
pnpm format
```

### No Test Suite

This project does not have a test suite configured.

## Code Style Guidelines

### Formatting (Prettier)

- **Indentation**: 2 spaces (no tabs)
- **Quotes**: Double quotes (`"`)
- **Semicolons**: Always
- **Trailing commas**: ES5 style
- **Print width**: 100 characters
- **Bracket same line**: true (JSX/Svelte attributes)

### TypeScript

- **Strict mode** enabled with `noUncheckedIndexedAccess`
- Never use `as any`, `@ts-ignore`, or `@ts-expect-error`
- Prefix unused variables with underscore: `_unusedVar`
- Use explicit types for function parameters and returns

### Imports

```typescript
// Path aliases (use these, not relative paths)
import { cn } from "$lib/utils";
import { SITE_TITLE } from "$lib/consts";
import type { Post } from "$lib/types/post";
import Header from "$lib/components/Header.svelte";
import { posts } from "$content/posts"; // Velite content

// shadcn-svelte components
import { Button } from "$lib/components/ui/button";
import * as Card from "$lib/components/ui/card";
```

### Svelte 5 Patterns

Always use Svelte 5 runes syntax:

```svelte
<script lang="ts">
	import { cn } from "$lib/utils";

	// Props with types
	interface Props {
		title: string;
		description?: string;
		children?: import("svelte").Snippet;
	}

	let { title, description = "", children }: Props = $props();

	// Derived values
	let fullTitle = $derived(`${title} | MinionAH`);

	// State
	let count = $state(0);
</script>

<!-- Render snippets -->
{@render children?.()}
```

### CSS & Styling

- Use Tailwind utility classes
- Use `cn()` for conditional classes (clsx + tailwind-merge)
- Dark theme only (no light mode support needed)
- Custom colors use oklch format in CSS variables

```svelte
<div class={cn("flex items-center gap-2", isActive && "bg-primary")}>
```

### Naming Conventions

- **Components**: PascalCase (`Header.svelte`, `FormattedDate.svelte`)
- **Files**: kebab-case for non-components
- **Variables/functions**: camelCase
- **Constants**: SCREAMING_SNAKE_CASE (`SITE_TITLE`)
- **Types/Interfaces**: PascalCase (`Post`, `Props`)

## Project Structure

```
src/
├── content/           # Markdown content (processed by Velite)
│   ├── posts/         # Blog posts
│   └── misc/          # Static pages (privacy, terms, guide)
├── lib/
│   ├── blueprints/    # MDSX layouts for markdown
│   │   ├── default/   # Blog post layout
│   │   └── misc/      # Privacy/ToS layout
│   ├── components/
│   │   └── ui/        # shadcn-svelte components (DO NOT EDIT)
│   ├── types/         # TypeScript type definitions
│   ├── consts.ts      # Site constants
│   ├── utils.ts       # cn() and utility types
│   └── utilities.ts   # Content fetching helpers
├── routes/
│   ├── [slug]/        # Dynamic post routes
│   ├── +layout.svelte
│   └── +page.svelte   # Homepage
└── app.css            # Global styles & Tailwind config
```

## Content System

### Adding Blog Posts

Create markdown files in `src/content/posts/`:

```markdown
---
title: "Post Title"
description: "Brief description"
pubDate: "Jan 1 2025"
heroImage: "/assets/images/post-name/banner.png"
isPublic: true
type: "update"
---

Post content here...
```

### Frontmatter Fields

- `title` (required): Post title
- `description` (required): Meta description
- `pubDate` (required): Publication date
- `heroImage` (required): Banner image path
- `isPublic` (required): Whether to show in listings
- `type` (required): Post category (update, announcement, etc.)
- `lastUpdated` (optional): Last modification date
- `classes` (optional): Custom CSS classes

### Blueprint Selection

- Posts in `posts/` use `blueprints/default/blueprint.svelte`
- Posts in `misc/` use `blueprints/misc/PrivacyTosBlueprint.svelte`

## shadcn-svelte Components

UI components in `src/lib/components/ui/` are generated by shadcn-svelte. **DO NOT manually edit
these files** - use `npx shadcn-svelte@latest add <component>`.

Available components: button, card, carousel, dropdown-menu, tabs

## Common Patterns

### Fetching Posts

```typescript
import { posts } from "$content/posts";

// All published posts, sorted by date
const publishedPosts = posts
	.filter((post) => post.isPublic)
	.sort((a, b) => new Date(b.pubDate).valueOf() - new Date(a.pubDate).valueOf());
```

### Page Data Loading

```typescript
// +page.ts
import type { PageLoad } from "./$types";
import { posts } from "$content/posts";

export const load: PageLoad = async () => {
	return { posts };
};
```

### Dynamic Post Routes

```typescript
// [slug]/+page.ts
import { error } from "@sveltejs/kit";
import { posts } from "$content/posts";

export const load: PageLoad = async ({ params }) => {
	const post = posts.find((p) => p.slugFull === params.slug);
	if (!post) throw error(404, "Post not found");
	return { post };
};
```

## ESLint Rules

- Unused vars must be prefixed with `_` or will error
- UI components (`src/lib/components/ui/**`) are excluded from linting
- Uses typescript-eslint recommended + svelte recommended

## Deployment

- Hosted on Cloudflare Pages
- Build output: Cloudflare adapter handles this
- Static assets in `static/` directory
